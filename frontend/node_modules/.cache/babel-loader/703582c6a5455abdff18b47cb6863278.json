{"ast":null,"code":"import _defineProperty from\"/Users/ziyizhang/Desktop/springboard/heroku/personal_ledger/fronend/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"/Users/ziyizhang/Desktop/springboard/heroku/personal_ledger/fronend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/Users/ziyizhang/Desktop/springboard/heroku/personal_ledger/fronend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/ziyizhang/Desktop/springboard/heroku/personal_ledger/fronend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/ziyizhang/Desktop/springboard/heroku/personal_ledger/fronend/node_modules/@babel/runtime/regenerator/index.js\";import React,{useState,useContext}from\"react\";import LedgerApi from\"../Api/api\";import UserContext from\"../auth/UserContext\";import Alert from\"../common/Alert\";import{useNavigate}from\"react-router-dom\";import Avatar from'@mui/material/Avatar';import Button from'@mui/material/Button';import CssBaseline from'@mui/material/CssBaseline';import TextField from'@mui/material/TextField';import FormControlLabel from'@mui/material/FormControlLabel';import Checkbox from'@mui/material/Checkbox';import Link from'@mui/material/Link';import Grid from'@mui/material/Grid';import Box from'@mui/material/Box';import LockOutlinedIcon from'@mui/icons-material/LockOutlined';import Typography from'@mui/material/Typography';import Container from'@mui/material/Container';import{createTheme,ThemeProvider}from'@mui/material/styles';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var theme=createTheme();function ProfileForm(){var _useContext=useContext(UserContext),currentUser=_useContext.currentUser,setCurrentUser=_useContext.setCurrentUser;var _useState=useState({firstName:currentUser.user.first_name,lastName:currentUser.user.last_name,email:currentUser.user.email,username:currentUser.user.username,password:\"\"}),_useState2=_slicedToArray(_useState,2),formData=_useState2[0],setFormData=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),formErrors=_useState4[0],setFormErrors=_useState4[1];var history=useNavigate();// switch to use our fancy limited-time-display message hook\nvar _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),saveConfirmed=_useState6[0],setSaveConfirmed=_useState6[1];// const [saveConfirmed, setSaveConfirmed] = useTimedMessage()\nconsole.debug(\"ProfileForm\",\"currentUser=\",currentUser,\"formData=\",formData,\"formErrors=\",formErrors,\"saveConfirmed=\",saveConfirmed);/** on form submit:\n     * - attempt save to backend & report any errors\n     * - if successful\n     *   - clear previous error messages and password\n     *   - show save-confirmed message\n     *   - set current user info throughout the site\n     */function handleSubmit(_x){return _handleSubmit.apply(this,arguments);}/** Handle form data changing */function _handleSubmit(){_handleSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(evt){var profileData,username,updatedUser;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:evt.preventDefault();profileData={first_name:formData.firstName,last_name:formData.lastName,email:formData.email};username=formData.username;_context.prev=3;_context.next=6;return LedgerApi.updateCurrentUser(username,profileData);case 6:updatedUser=_context.sent;_context.next=14;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](3);debugger;setFormErrors(_context.t0);return _context.abrupt(\"return\");case 14:setFormData(function(f){return _objectSpread(_objectSpread({},f),{},{password:\"\"});});setFormErrors([]);setSaveConfirmed(true);// trigger reloading of user information throughout the site\nsetCurrentUser(updatedUser);history(\"/profile\");case 19:case\"end\":return _context.stop();}}},_callee,null,[[3,9]]);}));return _handleSubmit.apply(this,arguments);}function handleChange(evt){var _evt$target=evt.target,name=_evt$target.name,value=_evt$target.value;setFormData(function(f){return _objectSpread(_objectSpread({},f),{},_defineProperty({},name,value));});setFormErrors([]);}return/*#__PURE__*/_jsx(\"div\",{className:\"col-md-6 col-lg-4 offset-md-3 offset-lg-4\",children:/*#__PURE__*/_jsx(ThemeProvider,{theme:theme,children:/*#__PURE__*/_jsxs(Container,{component:\"main\",maxWidth:\"xs\",children:[/*#__PURE__*/_jsx(CssBaseline,{}),/*#__PURE__*/_jsxs(Box,{sx:{marginTop:8,display:'flex',flexDirection:'column',alignItems:'center',borderColor:'white'},children:[/*#__PURE__*/_jsxs(Typography,{component:\"h1\",variant:\"h5\",children:[\"Username: \",formData.username]}),/*#__PURE__*/_jsxs(Box,{component:\"form\",noValidate:true,onSubmit:handleSubmit,sx:{mt:3},children:[/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsx(TextField,{autoComplete:\"given-name\",name:\"firstName\",required:true,fullWidth:true,id:\"firstName\",label:\"First Name\",autoFocus:true,value:formData.firstName,onChange:handleChange})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsx(TextField,{required:true,fullWidth:true,id:\"lastName\",label:\"Last Name\",name:\"lastName\",autoComplete:\"family-name\",value:formData.lastName,onChange:handleChange})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(TextField,{required:true,fullWidth:true,id:\"email\",label:\"Email Address\",name:\"email\",autoComplete:\"email\",value:formData.email,onChange:handleChange})})]}),/*#__PURE__*/_jsx(Button,{type:\"submit\",fullWidth:true,variant:\"contained\",sx:{mt:3,mb:2},children:\"Save Changes\"})]})]})]})})});}export default ProfileForm;","map":{"version":3,"names":["React","useState","useContext","LedgerApi","UserContext","Alert","useNavigate","Avatar","Button","CssBaseline","TextField","FormControlLabel","Checkbox","Link","Grid","Box","LockOutlinedIcon","Typography","Container","createTheme","ThemeProvider","theme","ProfileForm","currentUser","setCurrentUser","firstName","user","first_name","lastName","last_name","email","username","password","formData","setFormData","formErrors","setFormErrors","history","saveConfirmed","setSaveConfirmed","console","debug","handleSubmit","evt","preventDefault","profileData","updateCurrentUser","updatedUser","f","handleChange","target","name","value","marginTop","display","flexDirection","alignItems","borderColor","mt","mb"],"sources":["/Users/ziyizhang/Desktop/springboard/heroku/personal_ledger/fronend/src/profiles/ProfileForm.js"],"sourcesContent":["import React, { useState, useContext } from \"react\";\nimport LedgerApi from \"../Api/api\";\nimport UserContext from \"../auth/UserContext\";\nimport Alert from \"../common/Alert\";\nimport { useNavigate } from \"react-router-dom\";\nimport Avatar from '@mui/material/Avatar';\nimport Button from '@mui/material/Button';\nimport CssBaseline from '@mui/material/CssBaseline';\nimport TextField from '@mui/material/TextField';\nimport FormControlLabel from '@mui/material/FormControlLabel';\nimport Checkbox from '@mui/material/Checkbox';\nimport Link from '@mui/material/Link';\nimport Grid from '@mui/material/Grid';\nimport Box from '@mui/material/Box';\nimport LockOutlinedIcon from '@mui/icons-material/LockOutlined';\nimport Typography from '@mui/material/Typography';\nimport Container from '@mui/material/Container';\nimport { createTheme, ThemeProvider } from '@mui/material/styles';\n\n\n\nconst theme = createTheme();\n\nfunction ProfileForm() {\n    const { currentUser, setCurrentUser } = useContext(UserContext);\n    const [formData, setFormData] = useState({\n      firstName: currentUser.user.first_name,\n      lastName: currentUser.user.last_name,\n      email: currentUser.user.email,\n      username: currentUser.user.username,\n      password: \"\",\n    });\n    const [formErrors, setFormErrors] = useState([]);\n    \n    const history = useNavigate();\n\n    // switch to use our fancy limited-time-display message hook\n    const [saveConfirmed, setSaveConfirmed] = useState(false);\n    // const [saveConfirmed, setSaveConfirmed] = useTimedMessage()\n  \n    console.debug(\n        \"ProfileForm\",\n        \"currentUser=\", currentUser,\n        \"formData=\", formData,\n        \"formErrors=\", formErrors,\n        \"saveConfirmed=\", saveConfirmed,\n    );\n  \n    /** on form submit:\n     * - attempt save to backend & report any errors\n     * - if successful\n     *   - clear previous error messages and password\n     *   - show save-confirmed message\n     *   - set current user info throughout the site\n     */\n  \n    async function handleSubmit(evt) {\n      evt.preventDefault();\n  \n      let profileData = {\n        first_name: formData.firstName,\n        last_name: formData.lastName,\n        email: formData.email,\n      };\n  \n      let username = formData.username;\n      let updatedUser;\n  \n      try {\n        updatedUser = await LedgerApi.updateCurrentUser(username, profileData);\n      } catch (errors) {\n        debugger;\n        setFormErrors(errors);\n        return;\n      }\n  \n      setFormData(f => ({ ...f, password: \"\" }));\n      setFormErrors([]);\n      setSaveConfirmed(true);\n  \n      // trigger reloading of user information throughout the site\n      setCurrentUser(updatedUser);\n      history(`/profile`);\n    }\n  \n    /** Handle form data changing */\n    function handleChange(evt) {\n      const { name, value } = evt.target;\n      setFormData(f => ({\n        ...f,\n        [name]: value,\n      }));\n      setFormErrors([]);\n    }\n  \n    return (\n        <div className=\"col-md-6 col-lg-4 offset-md-3 offset-lg-4\">\n          {/* <h3>Profile</h3> */}\n          {/* <div className=\"card\">\n            <div className=\"card-body\">\n              <form>\n                <div className=\"form-group\">\n                  <label>Username</label>\n                  <p className=\"form-control-plaintext\">{formData.username}</p>\n                </div>\n                <div className=\"form-group\">\n                  <label>First Name</label>\n                  <input\n                      name=\"firstName\"\n                      className=\"form-control\"\n                      value={formData.firstName}\n                      onChange={handleChange}\n                  />\n                </div>\n                <div className=\"form-group\">\n                  <label>Last Name</label>\n                  <input\n                      name=\"lastName\"\n                      className=\"form-control\"\n                      value={formData.lastName}\n                      onChange={handleChange}\n                  />\n                </div>\n                <div className=\"form-group\">\n                  <label>Email</label>\n                  <input\n                      name=\"email\"\n                      className=\"form-control\"\n                      value={formData.email}\n                      onChange={handleChange}\n                  />\n                </div>\n                \n                {formErrors.length\n                    ? <Alert type=\"danger\" messages={formErrors} />\n                    : null}\n  \n                {saveConfirmed\n                    ?\n                    <Alert type=\"success\" messages={[\"Updated successfully.\"]} />\n                    : null}\n  \n                <button\n                    className=\"btn btn-primary btn-block mt-4\"\n                    onClick={handleSubmit}\n                >\n                  Save Changes\n                </button>\n              </form>\n            </div>\n          </div> */}\n          \n          <ThemeProvider theme={theme}>\n        \n      <Container component=\"main\" maxWidth=\"xs\">\n        <CssBaseline />\n        <Box\n          sx={{\n            marginTop: 8,\n            display: 'flex',\n            flexDirection: 'column',\n            alignItems: 'center',\n            borderColor: 'white',\n          }}\n        >\n          <Typography component=\"h1\" variant=\"h5\">\n            Username: {formData.username}\n          </Typography>\n          <Box component=\"form\" noValidate onSubmit={handleSubmit} sx={{ mt: 3 }}>\n            <Grid container spacing={2}>\n              <Grid item xs={12} sm={6}>\n                <TextField\n                  autoComplete=\"given-name\"\n                  name=\"firstName\"\n                  required\n                  fullWidth\n                  id=\"firstName\"\n                  label=\"First Name\"\n                  autoFocus\n                  value={formData.firstName}\n                      onChange={handleChange}\n                />\n              </Grid>\n              <Grid item xs={12} sm={6}>\n                <TextField\n                  required\n                  fullWidth\n                  id=\"lastName\"\n                  label=\"Last Name\"\n                  name=\"lastName\"\n                  autoComplete=\"family-name\"\n                  value={formData.lastName}\n                      onChange={handleChange}\n                />\n              </Grid>\n              <Grid item xs={12}>\n                <TextField\n                  required\n                  fullWidth\n                  id=\"email\"\n                  label=\"Email Address\"\n                  name=\"email\"\n                  autoComplete=\"email\"\n                  value={formData.email}\n                      onChange={handleChange}\n                />\n              </Grid>\n            </Grid>\n            <Button\n              type=\"submit\"\n              fullWidth\n              variant=\"contained\"\n              sx={{ mt: 3, mb: 2 }}\n            >\n              Save Changes\n            </Button>\n          </Box>\n        </Box>\n      </Container>\n    </ThemeProvider>\n        </div>\n    );\n  }\n  \n  export default ProfileForm;\n  "],"mappings":"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"},"metadata":{},"sourceType":"module"}